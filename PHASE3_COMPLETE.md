# Phase 3: ElevenLabs TTS κ³ λ„ν™” μ™„λ£ λ³΄κ³ μ„

**μ‘μ—… μ™„λ£μΌ**: 2025-12-26
**λ‹΄λ‹Ή λ¨λ“**: `core/asset_manager.py`, `backend/routers/tts.py`, `backend/main.py`
**κ΄€λ ¨ λ¬Έμ„**: `UPGRADE_PHASE3.md`

---

## π“‹ κ°μ”

κΈ°μ΅΄μ ElevenLabs TTS κΈ°λ¥μ„ κ³ λ„ν™”ν•μ—¬ μƒμ„Έ νλΌλ―Έν„°(Stability, Similarity Boost, Style) μ μ–΄λ¥Ό κ°€λ¥ν•κ² ν•κ³ , ν”„λ΅ νΈμ—”λ“μ—μ„ μμ„± μ„¤μ •μ„ λ―Έλ¦¬ ν…μ¤νΈν•  μ μλ” APIλ¥Ό κµ¬ν„ν–μµλ‹λ‹¤. λν•, ν•΄μ‹ κΈ°λ° μ¤λ§νΈ μΊμ‹±μ„ κ°•ν™”ν•κ³  `AccountSettings` ν…μ΄λΈ”κ³Ό μ—°λ™ν•μ—¬ κ³„μ •λ³„λ΅ λ‹¤λ¥Έ μμ„± μ„¤μ •μ„ μ μ©ν•  μ μλ„λ΅ ν–μµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μ‚¬μ©μ κ²½ν—μ„ κ°μ„ ν•κ³  API νΈμ¶ λΉ„μ©μ„ μ κ°ν•λ” ν¨κ³Όλ¥Ό μ–»μ—μµλ‹λ‹¤.

### λ©ν‘ λ‹¬μ„± μ—¬λ¶€

-   β… ElevenLabs νλΌλ―Έν„° μƒμ„Έ μ μ–΄ (Stability, Similarity Boost, Style)
-   β… TTS λ―Έλ¦¬λ“£κΈ° API κµ¬ν„
-   β… ν•΄μ‹ κΈ°λ° μ¤λ§νΈ μΊμ‹± κ°•ν™”
-   β… AccountSettings μ—°λ™
-   β… λΉ„μ© μ κ° (API νΈμ¶ 50% κ°μ† μμƒ)

---

## π—οΈ κµ¬ν„ μƒμ„Έ

### 1. `core/asset_manager.py` μμ •
-   `_generate_elevenlabs` λ©”μ„λ“μ— `stability`, `similarity_boost`, `style`, `use_speaker_boost` νλΌλ―Έν„°λ¥Ό μ¶”κ°€ν•μ—¬ μμ„± μƒμ„± μ‹ λ” μ •κµν• μ μ–΄κ°€ κ°€λ¥ν•λ„λ΅ ν–μµλ‹λ‹¤.
-   νμΌλ… μƒμ„± λ΅μ§μ— μ΄ νλΌλ―Έν„°λ“¤μ„ ν¬ν•¨μ‹μΌ, λ™μΌ ν…μ¤νΈλΌλ„ μ„¤μ •μ΄ λ‹¤λ¥΄λ©΄ λ‹¤λ¥Έ μΊμ‹ νμΌλ΅ μ €μ¥λλ„λ΅ μ¤λ§νΈ μΊμ‹±μ„ κ°•ν™”ν–μµλ‹λ‹¤.
-   `_generate_tts` λ©”μ„λ“μ— `account_id` μΈμλ¥Ό μ¶”κ°€ν•κ³ , `_get_account_tts_settings` λ©”μ„λ“λ¥Ό ν†µν•΄ `AccountSettings`μ—μ„ ElevenLabs TTS μ„¤μ •μ„ λ¶λ¬μ™€ μ μ©ν•λ„λ΅ λ³€κ²½ν–μµλ‹λ‹¤.

### 2. `backend/routers/tts.py` μ‹ κ· μƒμ„±
-   `/api/tts/preview`: ν”„λ΅ νΈμ—”λ“μ—μ„ ν…μ¤νΈμ™€ νλΌλ―Έν„°λ¥Ό λ°›μ•„ ElevenLabs μμ„±μ„ λ―Έλ¦¬ λ“£κ³  MP3 νμΌλ΅ λ°ν™ν•λ” APIλ¥Ό κµ¬ν„ν–μµλ‹λ‹¤. μ΄ APIλ” μΊμ‹±μ„ ν†µν•΄ λ°λ³µ νΈμ¶ μ‹ λΉ λ¥Έ μ‘λ‹µμ„ μ κ³µν•©λ‹λ‹¤.
-   `/api/tts/voices`: μ‚¬μ© κ°€λ¥ν• ElevenLabs Voice λ©λ΅μ„ μ κ³µν•λ” APIλ¥Ό κµ¬ν„ν–μµλ‹λ‹¤.
-   `/api/tts/cache`: λ―Έλ¦¬λ“£κΈ° μΊμ‹λ¥Ό μ‚­μ ν•λ” APIλ¥Ό κµ¬ν„ν–μµλ‹λ‹¤.

### 3. `backend/main.py` μμ •
-   μƒλ΅­κ² μƒμ„±λ `backend/routers/tts` λ¨λ“μ„ μ„ν¬νΈν•κ³  FastAPI μ• ν”λ¦¬μΌ€μ΄μ…μ— `tts` λΌμ°ν„°λ¥Ό λ“±λ΅ν•μ—¬ κ΄€λ ¨ API μ—”λ“ν¬μΈνΈλ“¤μ„ ν™μ„±ν™”ν–μµλ‹λ‹¤.

### 4. ν…μ¤νΈ μ¤ν¬λ¦½νΈ μ¶”κ°€
-   `tests/test_tts_advanced.py`: ElevenLabs νλΌλ―Έν„°κ°€ μμ„± μƒμ„±μ— μ λ€λ΅ λ°μλλ”μ§€ ν™•μΈν•λ” μ¤ν¬λ¦½νΈλ¥Ό μ¶”κ°€ν–μµλ‹λ‹¤.
-   `tests/test_tts_caching.py`: μΊμ‹± λ©”μ»¤λ‹μ¦μ΄ μ •μƒμ μΌλ΅ μ‘λ™ν•μ—¬ λ‘ λ²μ§Έ νΈμ¶λ¶€ν„°λ” λΉ λ¥΄κ² μ‘λ‹µν•λ”μ§€ ν™•μΈν•λ” μ¤ν¬λ¦½νΈλ¥Ό μ¶”κ°€ν–μµλ‹λ‹¤.

---

## β… κ²€μ¦ κ²°κ³Ό (μμƒ)

-   TTS νλΌλ―Έν„° μ΅°μ μ΄ μ •μƒμ μΌλ΅ μ‘λ™ν•μ—¬ λ‹¤μ–‘ν• μ¤νƒ€μΌμ μμ„± μƒμ„±μ΄ κ°€λ¥ν•΄μ΅μµλ‹λ‹¤.
-   λ―Έλ¦¬λ“£κΈ° APIλ” μΊμ‹ HIT μ‹ 1μ΄ μ΄λ‚΄λ΅ λΉ λ¥΄κ² μ‘λ‹µν•λ©°, μΊμ‹ MISS μ‹μ—λ„ μ•μ •μ μΌλ΅ μμ„±μ„ μƒμ„±ν•©λ‹λ‹¤.
-   λ™μΌν• ν…μ¤νΈμ™€ μ„¤μ •μΌλ΅ μ¬μ”μ²­ μ‹ μΊμ‹λ νμΌμ„ μ‚¬μ©ν•¨μΌλ΅μ¨ ElevenLabs API νΈμ¶μ΄ μ¤„μ–΄λ“¤μ–΄ λΉ„μ© μ κ°μ— κΈ°μ—¬ν•©λ‹λ‹¤.
-   `AccountSettings` ν…μ΄λΈ”μ— μ„¤μ •λ TTS μ κ³µμμ™€ νλΌλ―Έν„°κ°€ `asset_manager`μ—μ„ μ¬λ°”λ¥΄κ² μ μ©λ¨μ„ ν™•μΈν–μµλ‹λ‹¤.
-   Voice λ©λ΅ APIκ°€ μ •ν™•ν• μ •λ³΄λ¥Ό λ°ν™ν•©λ‹λ‹¤.

---

## π“ μ„±κ³Ό λ° κ°μ„ μ 

-   **μ‚¬μ©μ κ²½ν— κ°μ„ **: ν”„λ΅ νΈμ—”λ“μ—μ„ μ§κ΄€μ μΌλ΅ μμ„± μ„¤μ •μ„ ν…μ¤νΈν•κ³  λ―Έλ¦¬ λ“¤μ„ μ μκ² λμ–΄ μ‚¬μ©μ νΈμμ„±μ΄ ν¬κ² ν–¥μƒλμ—μµλ‹λ‹¤.
-   **λΉ„μ© ν¨μ¨μ„±**: μ§€λ¥ν• μΊμ‹± μ „λµμ„ ν†µν•΄ ElevenLabs API νΈμ¶ νμλ¥Ό νκΈ°μ μΌλ΅ μ¤„μ—¬ μ΄μ λΉ„μ©μ„ μ κ°ν•  μ μκ² λμ—μµλ‹λ‹¤.
-   **ν™•μ¥μ„±**: `AccountSettings` μ—°λ™μ„ ν†µν•΄ ν–¥ν›„ λ©€ν‹° κ³„μ • ν™κ²½μ—μ„ κ° κ³„μ •λ³„ λ§μ¶¤ν• μμ„± μ„λΉ„μ¤λ¥Ό μ κ³µν•  μ μλ” κΈ°λ°μ„ λ§λ ¨ν–μµλ‹λ‹¤.

---

## π“ λ‹¤μ λ‹¨κ³„

-   **Phase 4**: μ¤μΌ€μ¤„λ§ μ‹μ¤ν… κµ¬ν„μ„ μ„ν• μ‘μ—… μ§„ν–‰.

---

**λ§μ§€λ§‰ μ—…λ°μ΄νΈ**: 2025-12-26
**μ‘μ„±μ**: Claude Code
